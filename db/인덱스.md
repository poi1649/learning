
### 다중 칼럼 인덱스

- 실제 서비스에서는 하나의 컬럼만을 사용하는 인덱스보다 2개 이상의 칼럼을 함께 사용하는 인덱스가 더 많이 사용된다. 이를 **다중 칼럼 인덱스**라고 한다.

- 다중 칼럼 인덱스에서는 뒤에 명시된 칼럼이 항상 **앞에 명시된 칼럼에 의존적**으로 정렬된다.
- 이가 어떻게 설정되어있으냐에 따라 탐색에서 치명적인 성능차이를 보이므로 신중하게 결정해야한다.

- 인덱스는 오름차순 또는 내림차순으로 정렬될 수 있다. 
- 오름차순으로 정렬되어 있더라도 옵티마이저가 실행 계획을 세울 때 반대로 읽는게 효과적이라면 역순 스캔을 시도하게 된다.
- 역순 스캔은 일반적으로 정순 스캔보다 느리다. (이는 **페이지 잠금이 정순 스캔에 유리하게 걸리고**, 인덱스 테이블은 양방향 참조를 가지지만 인덱스 레코드는 단방향에 대한 참조만 가지고 있기 때문이다.)

- MySQL 8.0 부터는 다중 칼럼의 인덱스의 정렬 방법도 각자 다르게 설정할 수 있다.
```sql
CREATE INDEX ix_teamname_userscore ON employees (team_name ASC, user_score DESC);
```


### 인덱스의 가용성

- B-Tree 인덱스는 Left-most 의 특징을 가진다.  
	- 단일 칼럼 인덱스, 다중 칼럼 인덱스 모두에 적용된다.
	- 왼쪽 값을 기준으로 오른쪽값을 정렬한다. 
	- 왼쪽 값이 없으면 인덱스로 검색하더라도 인덱스 레인지 스캔을 사용하지 못한다.
- 다음과 같은 연산에서는 인덱스가 사용되지 못한다.
	- NOT-EQUAL 비교
	- 인덱스의 왼쪽 의외의 내용을 포함하는 LIKE 검색
	- 스토어드 함수나 다른 연산자로 칼럼 변형
	- NOT_DETERMINISTIC 스토어드 함수가 비교조건에 사용
	- 데이터 타입의 변환이 일어나는 비교
	- 문자열 데이터 타입의 콜레이션이 다른 비교
-